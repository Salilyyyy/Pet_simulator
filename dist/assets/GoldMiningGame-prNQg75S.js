import{r as i,j as e,m as l,A as N}from"./framer-ImROKbaA.js";import{u as P,s as v}from"./index-CWbnnzAN.js";import"./vendor-Bzgz95E1.js";import"./zustand-C3EHBv_w.js";const k=600,w=400,h=k/2,m=50,E=2,C=300,u=60,T=()=>{const{setMessage:y,completeMiniGame:p,currentPet:G}=P(),[t,g]=i.useState({goldNuggets:[],hookAngle:0,hookLength:50,hookExtended:!1,hookReturning:!1,hookX:h,hookY:m,score:0,isPlaying:!1,gameOver:!1,timeLeft:u,goldCollected:0}),j=i.useCallback(()=>{const s=[],o=8+Math.floor(Math.random()*5);for(let a=0;a<o;a++){const n=Math.random()<.6?"small":Math.random()<.85?"medium":"large",r=n==="small"?25:n==="medium"?50:100;s.push({id:a,x:50+Math.random()*(k-100),y:150+Math.random()*(w-200),value:r,size:n,collected:!1})}return s},[]),b=i.useCallback(()=>{const s=j();g({goldNuggets:s,hookAngle:0,hookLength:50,hookExtended:!1,hookReturning:!1,hookX:h,hookY:m,score:0,isPlaying:!0,gameOver:!1,timeLeft:u,goldCollected:0}),v.playGameStart()},[j]),M=i.useCallback(()=>{g({goldNuggets:[],hookAngle:0,hookLength:50,hookExtended:!1,hookReturning:!1,hookX:h,hookY:m,score:0,isPlaying:!1,gameOver:!1,timeLeft:u,goldCollected:0})},[]),L=i.useCallback(()=>{!t.isPlaying||t.hookExtended||t.hookReturning||g(s=>({...s,hookExtended:!0}))},[t.isPlaying,t.hookExtended,t.hookReturning]);i.useEffect(()=>{if(!t.isPlaying||t.hookExtended||t.hookReturning)return;let s,o=0;const a=n=>{n-o>=50&&(g(r=>{let c=r.hookAngle+2;c>90&&(c=-90),c<-90&&(c=90);const x=-c*Math.PI/180,f=h+Math.sin(x)*r.hookLength,d=m+Math.cos(x)*r.hookLength;return{...r,hookAngle:c,hookX:f,hookY:d}}),o=n),s=requestAnimationFrame(a)};return s=requestAnimationFrame(a),()=>cancelAnimationFrame(s)},[t.isPlaying,t.hookExtended,t.hookReturning]),i.useEffect(()=>{if(!t.isPlaying||t.hookExtended||t.hookReturning)return;const s=-t.hookAngle*Math.PI/180,o=h+Math.sin(s)*t.hookLength,a=m+Math.cos(s)*t.hookLength;g(n=>({...n,hookX:o,hookY:a}))},[t.hookAngle,t.hookLength,t.isPlaying,t.hookExtended,t.hookReturning]),i.useEffect(()=>{if(!t.hookExtended)return;const s=setInterval(()=>{g(o=>{if(o.hookReturning){const a=o.hookLength-E*2;return a<=50?{...o,hookExtended:!1,hookReturning:!1,hookLength:50}:{...o,hookLength:a}}else{const a=o.hookLength+E;if(a>=C)return{...o,hookReturning:!0};const n=-o.hookAngle*Math.PI/180,r=h+Math.sin(n)*a,c=m+Math.cos(n)*a;let x=null;const f=o.goldNuggets.map(d=>!d.collected&&Math.abs(r-d.x)<25&&Math.abs(c-d.y)<25?(x=d,{...d,collected:!0}):d);return x!==null?(v.playMatchSuccess(),{...o,goldNuggets:f,hookReturning:!0,score:o.score+x.value,goldCollected:o.goldCollected+1}):{...o,hookLength:a,hookX:r,hookY:c}}})},16);return()=>clearInterval(s)},[t.hookExtended]),i.useEffect(()=>{if(!t.isPlaying||t.gameOver)return;const s=setInterval(()=>{g(o=>{const a=o.timeLeft-1;return a<=0?{...o,timeLeft:0,isPlaying:!1,gameOver:!0}:{...o,timeLeft:a}})},1e3);return()=>clearInterval(s)},[t.isPlaying,t.gameOver]),i.useEffect(()=>{t.gameOver&&(p("gold-mining",t.score,Math.floor(t.score/10)),y(`‚õèÔ∏è Time's up! You collected ${t.goldCollected} gold nuggets! Score: ${t.score}`))},[t.gameOver,t.score,t.goldCollected,p,y]);const A=s=>{switch(s){case"small":return"ü™ô";case"medium":return"üí∞";case"large":return"üíé";default:return"ü™ô"}};return e.jsxs(l.div,{className:"max-w-4xl mx-auto p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(l.h2,{className:"text-3xl font-bold gradient-text mb-4",initial:{scale:1},animate:{scale:1},transition:{delay:.2},children:"‚õèÔ∏è Gold Mining"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Use your hook to collect gold nuggets! Time the release perfectly to grab the valuable ones!"}),!t.isPlaying&&!t.gameOver?e.jsx(l.button,{className:"bg-gradient-to-r from-yellow-500 to-orange-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:shadow-yellow-500/30 transition-all duration-300 btn-modern",onClick:b,whileHover:{scale:1.05},whileTap:{scale:.95},children:"‚õèÔ∏è Start Mining"}):e.jsxs("div",{className:"flex justify-center gap-6 mb-4",children:[e.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:["Score: ",t.score]})}),e.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:["Gold: ",t.goldCollected]})}),e.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:["Time: ",t.timeLeft,"s"]})})]})]}),e.jsxs(l.div,{className:"relative mb-6 flex justify-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},children:[e.jsxs("div",{className:"relative rounded-xl border-2 border-gray-600 bg-gradient-to-b from-blue-900/50 to-amber-900/50 overflow-hidden cursor-pointer",style:{width:k,height:w},onClick:L,children:[e.jsx("div",{className:"absolute bottom-0 w-full h-32 bg-gradient-to-t from-amber-800 to-amber-600"}),e.jsx("div",{className:"absolute w-4 h-4 bg-gray-600 rounded-full border-2 border-gray-400",style:{left:h-8,top:m-8}}),e.jsx("div",{className:"absolute",style:{left:h,top:m},children:e.jsx(l.div,{className:"bg-gray-400 relative",style:{width:2,height:t.hookLength,transformOrigin:"top center",transform:`rotate(${t.hookAngle}deg)`},children:e.jsx(l.div,{className:"absolute w-3 h-3 bg-gray-600 rounded-full border border-gray-400",style:{left:-6,top:t.hookLength-6},animate:{scale:t.hookExtended?[1,1.2,1]:1},transition:{duration:.3,repeat:t.hookExtended?1/0:0}})})}),e.jsx(N,{children:t.goldNuggets.map(s=>!s.collected&&e.jsx(l.div,{className:"absolute text-2xl",style:{left:s.x-12,top:s.y-12},initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0,y:-50},transition:{duration:.3,delay:s.id*.1},children:e.jsx(l.span,{animate:{y:[0,-5,0],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,delay:s.id*.2},children:A(s.size)})},s.id))}),t.isPlaying&&!t.hookExtended&&!t.hookReturning&&e.jsxs(l.div,{className:"absolute top-4 left-1/2 transform -translate-x-1/2 text-white text-center",animate:{opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0},children:[e.jsx("div",{className:"text-2xl",children:"üëÜ"}),e.jsx("div",{className:"text-sm font-bold",children:"Click to release hook!"})]})]}),e.jsx(N,{children:t.gameOver&&e.jsx(l.div,{className:"absolute inset-0 bg-black/80 rounded-xl flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(l.div,{className:"text-center glass-card p-6 rounded-2xl",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"‚è∞ Time's Up!"}),e.jsxs("p",{className:"text-gray-300 mb-4",children:["Gold Collected: ",t.goldCollected,e.jsx("br",{}),"Final Score: ",t.score]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(l.button,{className:"bg-gradient-to-r from-yellow-500 to-orange-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:b,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üîÑ Mine Again"}),e.jsx(l.button,{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:M,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üè† Back to Menu"})]})]})})})]}),!t.isPlaying&&!t.gameOver&&e.jsxs(l.div,{className:"glass-card p-6 rounded-2xl mt-6 max-w-2xl mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:"üìã How to Play"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"‚õèÔ∏è"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Hook:"})," Swings back and forth automatically"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ü™ô"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Small Gold:"})," 25 points"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üí∞"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Medium Gold:"})," 50 points"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üíé"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Large Gold:"})," 100 points"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üëÜ"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Timing:"})," Click when hook is near gold!"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"‚è∞"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Time:"})," ",u," seconds to collect as much as possible!"]})]})]})]})]})};export{T as default};
