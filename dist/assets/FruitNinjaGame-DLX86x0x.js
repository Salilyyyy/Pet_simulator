import{r as o,j as s,m as r}from"./framer-ImROKbaA.js";import{u as ie,s as D}from"./index-CWbnnzAN.js";import"./vendor-Bzgz95E1.js";import"./zustand-C3EHBv_w.js";const S={apple:{emoji:"üçé",points:10,color:"#ff4444"},banana:{emoji:"üçå",points:15,color:"#ffdd44"},orange:{emoji:"üçä",points:12,color:"#ff8844"},grape:{emoji:"üçá",points:8,color:"#8844ff"},watermelon:{emoji:"üçâ",points:20,color:"#44ff44"},bomb:{emoji:"üí£",points:-50,color:"#444444"}},he=()=>{const{setMessage:le,completeMiniGame:x}=ie(),g=o.useRef(null),y=o.useRef(),[c,F]=o.useState(!1),[d,j]=o.useState(!1),[m,E]=o.useState(0),[w,M]=o.useState(0),[X,G]=o.useState(60),[h,R]=o.useState(3),[p,u]=o.useState([]),[P,T]=o.useState([]),[L,C]=o.useState([]),[J,I]=o.useState(!1),[$,H]=o.useState(null),[l,k]=o.useState(null),b=800,f=600,O=.3,K=.02,B=o.useCallback((n,t)=>{const e=Object.keys(S),a=e[Math.floor(Math.random()*e.length)],i=S[a];return{id:`fruit-${Date.now()}-${Math.random()}`,x:n??Math.random()*b,y:t??f+50,vx:(Math.random()-.5)*8,vy:-(Math.random()*8+12),rotation:0,rotationSpeed:(Math.random()-.5)*.2,type:a,emoji:i.emoji,size:40+Math.random()*20,sliced:!1}},[]),Y=n=>{const t=[];for(let a=0;a<8;a++)t.push({id:`particle-${Date.now()}-${a}`,x:n.x,y:n.y,vx:(Math.random()-.5)*10,vy:(Math.random()-.5)*10,life:30,maxLife:30,color:S[n.type].color,size:4+Math.random()*4});T(a=>[...a,...t])},Q=n=>{if(n.sliced)return;const e=S[n.type].points*(w>0?w+1:1);n.type==="bomb"?(D.playMatchFailure(),Y(n),j(!0),x("fruit-ninja",m,2)):(E(a=>a+e),M(a=>a+1),D.playMatchSuccess(),Y(n)),u(a=>a.map(i=>i.id===n.id?{...i,sliced:!0,sliceTime:Date.now()}:i))},Z=(n,t)=>{p.forEach(e=>{if(e.sliced)return;const a=t.x-n.x,i=t.y-n.y,v=Math.sqrt(a*a+i*i);if(v===0)return;const W=a/v,V=i/v,se=e.x-n.x,ne=e.y-n.y,N=se*W+ne*V,ae=n.x+N*W,oe=n.y+N*V;Math.sqrt((e.x-ae)**2+(e.y-oe)**2)<=e.size/2&&N>=0&&N<=v&&Q(e)})},ee=n=>{if(!c||d)return;const t=g.current?.getBoundingClientRect();if(!t)return;const e=n.clientX-t.left,a=n.clientY-t.top;I(!0),H({x:e,y:a});const i={id:`trail-${Date.now()}`,points:[{x:e,y:a,time:Date.now()}],life:10};k(i)},te=n=>{if(!J||!c||d)return;const t=g.current?.getBoundingClientRect();if(!t)return;const e=n.clientX-t.left,a=n.clientY-t.top;$&&Z($,{x:e,y:a}),k(i=>i?{...i,points:[...i.points,{x:e,y:a,time:Date.now()}]}:null)},z=()=>{I(!1),H(null),l&&C(n=>[...n,l]),k(null)},U=o.useCallback(()=>{u(t=>t.map(e=>e.sliced&&e.sliceTime&&Date.now()-e.sliceTime>500?null:{...e,x:e.x+e.vx,y:e.y+e.vy,vy:e.vy+O,rotation:e.rotation+e.rotationSpeed}).filter(Boolean)),T(t=>t.map(e=>({...e,x:e.x+e.vx,y:e.y+e.vy,vy:e.vy+.1,life:e.life-1})).filter(e=>e.life>0)),C(t=>t.map(e=>({...e,life:e.life-1})).filter(e=>e.life>0)),Math.random()<K&&u(t=>[...t,B()]),u(t=>t.filter(e=>e.y<f+100&&e.x>-100&&e.x<b+100));const n=p.filter(t=>!t.sliced&&t.y>f+50);n.length>0&&(M(0),R(t=>Math.max(0,t-n.length)))},[p,B]),_=o.useCallback(()=>{const n=g.current;if(!n)return;const t=n.getContext("2d");if(t){if(t.clearRect(0,0,b,f),L.forEach(e=>{if(!(e.points.length<2)){t.strokeStyle=`rgba(255, 255, 255, ${e.life/10})`,t.lineWidth=3,t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(e.points[0].x,e.points[0].y);for(let a=1;a<e.points.length;a++)t.lineTo(e.points[a].x,e.points[a].y);t.stroke()}}),l&&l.points.length>1){t.strokeStyle="rgba(255, 255, 255, 0.8)",t.lineWidth=4,t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(l.points[0].x,l.points[0].y);for(let e=1;e<l.points.length;e++)t.lineTo(l.points[e].x,l.points[e].y);t.stroke()}P.forEach(e=>{const a=e.life/e.maxLife;t.fillStyle=e.color.replace(")",`, ${a})`).replace("rgb","rgba"),t.beginPath(),t.arc(e.x,e.y,e.size,0,Math.PI*2),t.fill()}),p.forEach(e=>{e.sliced&&e.sliceTime&&Date.now()-e.sliceTime>200||(t.save(),t.translate(e.x,e.y),t.rotate(e.rotation),t.font=`${e.size}px Arial`,t.textAlign="center",t.textBaseline="middle",e.sliced?(t.globalAlpha=.7,t.fillText(e.emoji,-10,0),t.fillText(e.emoji,10,0)):t.fillText(e.emoji,0,0),t.restore())})}},[p,P,L,l]),A=o.useCallback(()=>{U(),_(),y.current=requestAnimationFrame(A)},[U,_]);o.useEffect(()=>(c&&!d&&(y.current=requestAnimationFrame(A)),()=>{y.current&&cancelAnimationFrame(y.current)}),[c,d,A]),o.useEffect(()=>{if(!c||d)return;const n=setInterval(()=>{G(t=>t<=1?(j(!0),x("fruit-ninja",m,0),0):t-1)},1e3);return()=>clearInterval(n)},[c,d,m,x]),o.useEffect(()=>{h<=0&&(j(!0),x("fruit-ninja",m,1))},[h,m,x]);const q=()=>{F(!0),E(0),M(0),G(60),R(3),u([]),T([]),C([]),j(!1),D.playGameStart()};return s.jsxs(r.div,{className:"max-w-4xl mx-auto p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(r.h2,{className:"text-3xl font-bold gradient-text mb-4",initial:{scale:.9},animate:{scale:1},transition:{delay:.2},children:"üó°Ô∏è Fruit Ninja"}),s.jsx("p",{className:"text-gray-300 mb-4",children:"Slice fruits by dragging your mouse! Avoid the bombs!"}),c?s.jsxs("div",{className:"flex justify-center gap-6 mb-4",children:[s.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:s.jsxs("span",{className:"text-white font-semibold",children:["Score: ",m]})}),s.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:s.jsxs("span",{className:"text-white font-semibold",children:["Combo: ",w,"x"]})}),s.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:s.jsxs("span",{className:"text-white font-semibold",children:["Lives: ",h]})}),s.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:s.jsxs("span",{className:"text-white font-semibold",children:["Time: ",X,"s"]})})]}):s.jsx(r.button,{className:"bg-gradient-to-r from-red-500 to-pink-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:shadow-red-500/30 transition-all duration-300 btn-modern",onClick:q,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üéÆ Start Slicing!"})]}),c&&s.jsx(r.div,{className:"flex justify-center mb-6",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},children:s.jsx("canvas",{ref:g,width:b,height:f,className:"border-2 border-gray-600 rounded-xl bg-gradient-to-b from-blue-900 to-blue-950 cursor-crosshair",onMouseDown:ee,onMouseMove:te,onMouseUp:z,onMouseLeave:z})}),d&&s.jsx(r.div,{className:"text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:s.jsxs("div",{className:"glass-card p-6 rounded-2xl inline-block",children:[s.jsx("h3",{className:"text-3xl font-bold text-white mb-4",children:h<=0?"üí• Game Over!":"‚è∞ Time's Up!"}),s.jsxs("p",{className:"text-xl text-yellow-400 mb-4",children:["Final Score: ",m]}),s.jsx("p",{className:"text-gray-300 mb-6",children:h<=0?"You hit a bomb!":"Great slicing!"}),s.jsxs("div",{className:"flex gap-3 justify-center",children:[s.jsx(r.button,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:q,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üîÑ Play Again"}),s.jsx(r.button,{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:()=>F(!1),whileHover:{scale:1.05},whileTap:{scale:.95},children:"üè† Back to Menu"})]})]})}),!c&&s.jsxs(r.div,{className:"glass-card p-6 rounded-2xl mt-6 max-w-2xl mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:"üìã How to Play"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-300",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:"üó°Ô∏è"}),s.jsxs("div",{children:[s.jsx("strong",{className:"text-white",children:"Slice:"})," Click and drag to slice fruits"]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:"üçé"}),s.jsxs("div",{children:[s.jsx("strong",{className:"text-white",children:"Fruits:"})," Different fruits give different points"]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:"üí£"}),s.jsxs("div",{children:[s.jsx("strong",{className:"text-white",children:"Bombs:"})," Avoid slicing bombs or lose a life"]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("span",{className:"text-2xl",children:"üî•"}),s.jsxs("div",{children:[s.jsx("strong",{className:"text-white",children:"Combo:"})," Chain slices for bonus points"]})]})]})]})]})};export{he as default};
