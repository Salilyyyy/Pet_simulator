import{r as c,j as t,m as f,A as B}from"./framer-ImROKbaA.js";import{u as W,s as z}from"./index-DIWj36YF.js";import"./vendor-Bzgz95E1.js";import"./zustand-C3EHBv_w.js";const h=800,x=600,v=2,q=4,M=10,H=200,F=5,U=.5,Z=()=>{const{setMessage:E,completeMiniGame:C,currentPet:S}=W(),N=c.useRef(null),j=c.useRef(void 0),k=c.useRef({x:0,y:0}),[i,b]=c.useState({player:{id:"player",segments:[{x:h/2,y:x/2}],direction:0,speed:v,size:M,color:"#4ade80",isPlayer:!0},pellets:[],enemies:[],score:0,gameOver:!1,isPlaying:!1,boost:!1}),O=c.useCallback(()=>{const e=[];for(let s=0;s<H;s++)e.push({id:`pellet-${s}`,x:Math.random()*h,y:Math.random()*x,size:2+Math.random()*3});return e},[]),T=c.useCallback(()=>{const e=[],s=["#ef4444","#f97316","#eab308","#8b5cf6","#ec4899"];for(let o=0;o<F;o++)e.push({id:`enemy-${o}`,segments:[{x:Math.random()*h,y:Math.random()*x}],direction:Math.random()*Math.PI*2,speed:v*.8,size:M+Math.random()*20,color:s[o%s.length],isPlayer:!1});return e},[]),g=c.useCallback((e,s,o,a)=>{const n=e.x-o.x,r=e.y-o.y;return Math.sqrt(n*n+r*r)<(s+a)/2},[]),A=c.useCallback((e,s,o,a)=>{const n=e-o,r=s-a;return Math.atan2(r,n)},[]),w=c.useCallback((e,s)=>{const o=s!==void 0?s:e.direction,a=i.boost?q:e.speed,n={...e.segments[0]};n.x+=Math.cos(o)*a,n.y+=Math.sin(o)*a,n.x<0&&(n.x=h),n.x>h&&(n.x=0),n.y<0&&(n.y=x),n.y>x&&(n.y=0);const r=[n,...e.segments];return r.length>Math.floor(e.size)&&r.pop(),{...e,segments:r,direction:o}},[i.boost]),D=c.useCallback(e=>e.map(s=>{let o=s.direction;return Math.random()<.02&&(o=Math.random()*Math.PI*2),w(s,o)}),[w]),R=c.useCallback((e,s)=>{let o=[...s],a=e.size,n=i.score;for(e.segments.forEach(r=>{o=o.filter(m=>g(r,e.size,{x:m.x,y:m.y},m.size)?(a+=U,n+=10,z.playMatchSuccess(),!1):!0)});o.length<H;)o.push({id:Date.now()+Math.random(),x:Math.random()*h,y:Math.random()*x,size:2+Math.random()*3});return{newPellets:o,newSize:a,newScore:n}},[i.score,g]),$=c.useCallback((e,s,o)=>{let a=[...s],n=[...o],r=!1,m=e.size,p=i.score;a=a.filter(l=>e.size>l.size*1.2&&g(e.segments[0],e.size,l.segments[0],l.size)?(m+=l.size*.5,p+=Math.floor(l.size),z.playMatchSuccess(),!1):!0);for(const l of a){for(const u of l.segments)if(g(e.segments[0],e.size,u,l.size)){r=!0;const y=Math.floor(e.size/2);for(let d=0;d<y;d++)n.push({id:`food-${Date.now()}-${d}`,x:e.segments[0].x+(Math.random()-.5)*50,y:e.segments[0].y+(Math.random()-.5)*50,size:3+Math.random()*4});break}if(r)break}for(const l of a)if(l.size>e.size*1.2&&g(l.segments[0],l.size,e.segments[0],e.size)){r=!0;const y=Math.floor(e.size/2);for(let d=0;d<y;d++)n.push({id:`food-${Date.now()}-${d}`,x:e.segments[0].x+(Math.random()-.5)*50,y:e.segments[0].y+(Math.random()-.5)*50,size:3+Math.random()*4});break}for(a=a.filter(l=>{for(const u of e.segments.slice(1))if(g(l.segments[0],l.size,u,e.size)){const y=Math.floor(l.size/2);for(let d=0;d<y;d++)n.push({id:`food-enemy-${Date.now()}-${d}`,x:l.segments[0].x+(Math.random()-.5)*50,y:l.segments[0].y+(Math.random()-.5)*50,size:3+Math.random()*4});return!1}for(const u of a)if(u.id!==l.id){for(const y of u.segments.slice(1))if(g(l.segments[0],l.size,y,u.size)){const d=Math.floor(l.size/2);for(let P=0;P<d;P++)n.push({id:`food-enemy-${Date.now()}-${P}`,x:l.segments[0].x+(Math.random()-.5)*50,y:l.segments[0].y+(Math.random()-.5)*50,size:3+Math.random()*4});return!1}}return!0});a.length<F;)a.push({id:`enemy-${Date.now()}-${Math.random()}`,segments:[{x:Math.random()*h,y:Math.random()*x}],direction:Math.random()*Math.PI*2,speed:v*.8,size:M+Math.random()*20,color:["#ef4444","#f97316","#eab308","#8b5cf6","#ec4899"][a.length%5],isPlayer:!1});return{newEnemies:a,newPellets:n,gameOver:r,newSize:m,newScore:p}},[i.score,g]),G=c.useCallback(()=>{b(e=>{if(e.gameOver||!e.isPlaying)return e;const s=k.current,o=e.player.segments[0],a=A(s.x,s.y,o.x,o.y),n=w({...e.player,direction:a}),r=D(e.enemies),m=R(n,e.pellets),p=$({...n,size:m.newSize},r,m.newPellets);return{...e,player:{...n,size:p.newSize},pellets:m.newPellets,enemies:p.newEnemies,score:p.newScore,gameOver:p.gameOver}})},[w,D,R,$,A]),I=c.useCallback(()=>{const e=N.current;if(!e)return;const s=e.getContext("2d");if(!s)return;s.fillStyle="#0f172a",s.fillRect(0,0,h,x),i.pellets.forEach(a=>{s.fillStyle="#fbbf24",s.beginPath(),s.arc(a.x,a.y,a.size,0,Math.PI*2),s.fill()}),i.enemies.forEach(a=>{s.strokeStyle=a.color,s.lineWidth=Math.max(2,a.size/4),s.lineCap="round",s.lineJoin="round",s.beginPath(),a.segments.forEach((n,r)=>{r===0?s.moveTo(n.x,n.y):s.lineTo(n.x,n.y)}),s.stroke(),s.fillStyle=a.color,s.beginPath(),s.arc(a.segments[0].x,a.segments[0].y,a.size/2,0,Math.PI*2),s.fill()}),s.strokeStyle=i.player.color,s.lineWidth=Math.max(2,i.player.size/4),s.lineCap="round",s.lineJoin="round",s.beginPath(),i.player.segments.forEach((a,n)=>{n===0?s.moveTo(a.x,a.y):s.lineTo(a.x,a.y)}),s.stroke();const o=i.player.segments[0];s.fillStyle=i.player.color,s.beginPath(),s.arc(o.x,o.y,i.player.size/2,0,Math.PI*2),s.fill(),s.fillStyle="#ffffff",s.font=`${i.player.size}px Arial`,s.textAlign="center",s.textBaseline="middle",s.fillText(S?.typeData.emoji||"üêç",o.x,o.y)},[i,S]);c.useEffect(()=>{const e=N.current;if(!e)return;const s=n=>{const r=e.getBoundingClientRect();k.current={x:n.clientX-r.left,y:n.clientY-r.top}},o=()=>{b(n=>({...n,boost:!0}))},a=()=>{b(n=>({...n,boost:!1}))};return e.addEventListener("mousemove",s),e.addEventListener("mousedown",o),e.addEventListener("mouseup",a),()=>{e.removeEventListener("mousemove",s),e.removeEventListener("mousedown",o),e.removeEventListener("mouseup",a)}},[i.isPlaying]),c.useEffect(()=>{if(i.isPlaying&&!i.gameOver){const e=()=>{G(),j.current=requestAnimationFrame(e)};j.current=requestAnimationFrame(e)}return()=>{j.current&&cancelAnimationFrame(j.current)}},[i.isPlaying,i.gameOver,G]),c.useEffect(()=>{i.isPlaying&&I()},[i,I]),c.useEffect(()=>{i.gameOver&&(z.playMatchFailure(),C("slither-game",i.score,Math.floor(i.score/50)),E(`üêç Game Over! Final Score: ${i.score}`))},[i.gameOver,i.score,C,E]);const L=c.useCallback(()=>{const e=O(),s=T();b({player:{id:"player",segments:[{x:h/2,y:x/2}],direction:0,speed:v,size:M,color:"#4ade80",isPlayer:!0},pellets:e,enemies:s,score:0,gameOver:!1,isPlaying:!0,boost:!1}),z.playGameStart()},[O,T]),_=c.useCallback(()=>{b({player:{id:"player",segments:[{x:h/2,y:x/2}],direction:0,speed:v,size:M,color:"#4ade80",isPlayer:!0},pellets:[],enemies:[],score:0,gameOver:!1,isPlaying:!1,boost:!1})},[]);return t.jsxs(f.div,{className:"max-w-6xl mx-auto p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[t.jsxs("div",{className:"text-center mb-6",children:[t.jsx(f.h2,{className:"text-3xl font-bold gradient-text mb-4",initial:{scale:1},animate:{scale:1},transition:{delay:.2},children:"üêç Slither Game"}),t.jsx("p",{className:"text-gray-300 mb-4",children:"Control your pet worm! Eat pellets and smaller enemies to grow bigger!"}),!i.isPlaying&&!i.gameOver?t.jsx(f.button,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:shadow-green-500/30 transition-all duration-300 btn-modern",onClick:L,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üéÆ Start Game"}):t.jsxs("div",{className:"flex justify-center gap-6 mb-4",children:[t.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:t.jsxs("span",{className:"text-white font-semibold",children:["Score: ",i.score]})}),t.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:t.jsxs("span",{className:"text-white font-semibold",children:["Size: ",Math.floor(i.player.size)]})}),t.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:t.jsxs("span",{className:"text-white font-semibold",children:["Boost: ",i.boost?"ON":"OFF"]})})]})]}),t.jsxs(f.div,{className:"relative mb-6 flex justify-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},children:[t.jsx("canvas",{ref:N,width:h,height:x,className:"border-2 border-gray-600 rounded-xl bg-slate-900 cursor-none",style:{maxWidth:"100%",height:"auto"}}),t.jsx(B,{children:i.gameOver&&t.jsx(f.div,{className:"absolute inset-0 bg-black/80 rounded-xl flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:t.jsxs(f.div,{className:"text-center glass-card p-6 rounded-2xl",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},children:[t.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"üíÄ Game Over!"}),t.jsxs("p",{className:"text-gray-300 mb-4",children:["Final Score: ",i.score,t.jsx("br",{}),"Final Size: ",Math.floor(i.player.size)]}),t.jsxs("div",{className:"flex gap-3 justify-center",children:[t.jsx(f.button,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:L,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üîÑ Play Again"}),t.jsx(f.button,{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:_,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üè† Back to Menu"})]})]})})})]}),i.isPlaying&&t.jsx(f.div,{className:"text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:t.jsxs("div",{className:"glass-card p-4 rounded-xl inline-block",children:[t.jsx("h4",{className:"text-white font-bold mb-2",children:"üéÆ Controls"}),t.jsxs("div",{className:"text-sm text-gray-300 grid grid-cols-2 gap-2",children:[t.jsx("div",{children:"üñ±Ô∏è Move: Mouse"}),t.jsx("div",{children:"‚ö° Boost: Click & Hold"}),t.jsx("div",{children:"üçé Pellets: +10 points"}),t.jsx("div",{children:"üêõ Enemies: Size bonus"})]})]})}),!i.isPlaying&&!i.gameOver&&t.jsxs(f.div,{className:"glass-card p-6 rounded-2xl mt-6 max-w-2xl mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[t.jsx("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:"üìã How to Play"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-300",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:"üñ±Ô∏è"}),t.jsxs("div",{children:[t.jsx("strong",{className:"text-white",children:"Mouse Control:"})," Move mouse to steer your worm"]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:"‚ö°"}),t.jsxs("div",{children:[t.jsx("strong",{className:"text-white",children:"Boost:"})," Click and hold to move faster"]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:"üçé"}),t.jsxs("div",{children:[t.jsx("strong",{className:"text-white",children:"Pellets:"})," Eat yellow pellets to grow"]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:"üêõ"}),t.jsxs("div",{children:[t.jsx("strong",{className:"text-white",children:"Enemies:"})," Eat smaller worms to grow big"]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:"üîÑ"}),t.jsxs("div",{children:[t.jsx("strong",{className:"text-white",children:"World:"})," Edges wrap around"]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:"üíÄ"}),t.jsxs("div",{children:[t.jsx("strong",{className:"text-white",children:"Danger:"})," Don't get eaten by bigger worms"]})]})]})]})]})};export{Z as default};
