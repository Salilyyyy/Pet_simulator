import{r as o,j as e,m as i}from"./framer-ImROKbaA.js";import{u as U,s as b}from"./index-CWbnnzAN.js";import"./vendor-Bzgz95E1.js";import"./zustand-C3EHBv_w.js";const c=10,p=20,f=30,z=[{shape:[[1,1,1,1]],color:"#00f5ff"},{shape:[[1,1],[1,1]],color:"#ffff00"},{shape:[[0,1,0],[1,1,1]],color:"#800080"},{shape:[[0,1,1],[1,1,0]],color:"#00ff00"},{shape:[[1,1,0],[0,1,1]],color:"#ff0000"},{shape:[[1,0,0],[1,1,1]],color:"#0000ff"},{shape:[[0,0,1],[1,1,1]],color:"#ffa500"}],F=()=>{const{setMessage:H,completeMiniGame:$}=U(),[u,S]=o.useState(()=>Array(p).fill(null).map(()=>Array(c).fill(null).map(()=>({filled:!1,color:""})))),[n,v]=o.useState(null),[g,M]=o.useState(null),[N,B]=o.useState(0),[m,D]=o.useState(0),[w,G]=o.useState(1),[d,C]=o.useState(!1),[x,R]=o.useState(!1),k=o.useRef(null),y=o.useRef(1e3),T=o.useCallback(()=>{const s=Math.floor(Math.random()*z.length),t=z[s];return{shape:t.shape,color:t.color,x:Math.floor(c/2)-Math.floor(t.shape[0].length/2),y:0}},[]),P=s=>{const t=s.shape[0].map((a,l)=>s.shape.map(r=>r[l]).reverse());return{...s,shape:t}},A=(s,t,a)=>{for(let l=0;l<s.shape.length;l++)for(let r=0;r<s.shape[l].length;r++)if(s.shape[l][r]){const h=t+r,L=a+l;if(h<0||h>=c||L>=p||L>=0&&u[L][h].filled)return!1}return!0},I=o.useCallback(s=>{const t=u.map(a=>[...a]);for(let a=0;a<s.shape.length;a++)for(let l=0;l<s.shape[a].length;l++)if(s.shape[a][l]){const r=s.y+a,h=s.x+l;r>=0&&(t[r][h]={filled:!0,color:s.color})}return S(t),t},[u]),_=o.useCallback(s=>{const t=[];for(let a=p-1;a>=0;a--)s[a].every(l=>l.filled)&&t.push(a);if(t.length>0){b.playMatchSuccess();const a=s.filter((r,h)=>!t.includes(h)),l=Array(t.length).fill(null).map(()=>Array(c).fill(null).map(()=>({filled:!1,color:""})));S([...l,...a]),D(r=>r+t.length),B(r=>r+t.length*100*w),m+t.length>=w*10&&(G(r=>r+1),y.current=Math.max(100,y.current-50),b.playGameComplete())}},[u,m,w]),O=()=>{const s=Array(p).fill(null).map(()=>Array(c).fill(null).map(()=>({filled:!1,color:""})));S(s),v(T()),M(T()),B(0),D(0),G(1),R(!1),C(!0),y.current=1e3,b.playGameStart()},j=(s,t)=>{if(!n||x)return;const a=n.x+s,l=n.y+t;if(A(n,a,l))v({...n,x:a,y:l}),s!==0&&b.playTileSelect();else if(t>0){const r=I(n);if(_(r),n.y<=0){R(!0),C(!1),$("puzzle-game",N,m),H(`üíî Game Over! Score: ${N}, Lines: ${m}`);return}v(g),M(T())}},X=()=>{if(!n||x)return;const s=P(n);A(s,s.x,s.y)&&(v(s),b.playTileSelect())},E=()=>{j(0,1)},Y=()=>{if(!n)return;let s=0;for(;A(n,n.x,n.y+s+1);)s++;s>0&&(B(t=>t+s*2),j(0,s))};o.useEffect(()=>{const s=t=>{if(!(!d||x))switch(t.key){case"ArrowLeft":t.preventDefault(),j(-1,0);break;case"ArrowRight":t.preventDefault(),j(1,0);break;case"ArrowDown":t.preventDefault(),j(0,1);break;case"ArrowUp":t.preventDefault(),X();break;case" ":t.preventDefault(),Y();break}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[d,x,n]),o.useEffect(()=>{if(!d||x)return;const s=()=>{E(),k.current=setTimeout(s,y.current)};return k.current=setTimeout(s,y.current),()=>{k.current&&clearTimeout(k.current)}},[d,x,E]);const K=()=>{const s=u.map(t=>[...t]);if(n){for(let t=0;t<n.shape.length;t++)for(let a=0;a<n.shape[t].length;a++)if(n.shape[t][a]){const l=n.y+t,r=n.x+a;l>=0&&l<p&&r>=0&&r<c&&(s[l][r]={filled:!0,color:n.color})}}return s};return e.jsxs(i.div,{className:"max-w-6xl mx-auto p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(i.h2,{className:"text-3xl font-bold gradient-text mb-4",initial:{scale:.9},animate:{scale:1},transition:{delay:.2},children:"üß© Block Puzzle"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Arrange falling blocks to complete horizontal lines!"}),d?e.jsxs("div",{className:"flex justify-center gap-6 mb-4",children:[e.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:["Score: ",N]})}),e.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:["Lines: ",m]})}),e.jsx("div",{className:"glass-card px-4 py-2 rounded-lg",children:e.jsxs("span",{className:"text-white font-semibold",children:["Level: ",w]})})]}):e.jsx(i.button,{className:"bg-gradient-to-r from-purple-500 to-pink-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:shadow-purple-500/30 transition-all duration-300 btn-modern",onClick:O,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üéÆ Start Game"})]}),d&&e.jsxs(i.div,{className:"flex justify-center gap-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"bg-black/50 border-2 border-gray-600 rounded-lg p-2",style:{width:c*f+16,height:p*f+16},children:e.jsx("div",{className:"grid gap-0",style:{gridTemplateColumns:`repeat(${c}, 1fr)`},children:K().map((s,t)=>s.map((a,l)=>e.jsx(i.div,{className:"border border-gray-700",style:{width:f,height:f,backgroundColor:a.filled?a.color:"transparent"},animate:{scale:a.filled?[1,1.05,1]:1},transition:{duration:.1}},`${l}-${t}`)))})}),x&&e.jsx(i.div,{className:"absolute inset-0 bg-black/80 flex items-center justify-center rounded-lg",initial:{opacity:0},animate:{opacity:1},children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-3xl font-bold text-white mb-4",children:"üíî Game Over!"}),e.jsxs("p",{className:"text-gray-300 mb-4",children:["Score: ",N," | Lines: ",m]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(i.button,{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:O,whileHover:{scale:1.05},whileTap:{scale:.95},children:"üîÑ Play Again"}),e.jsx(i.button,{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-2 rounded-xl font-bold btn-modern",onClick:()=>C(!1),whileHover:{scale:1.05},whileTap:{scale:.95},children:"üè† Back to Menu"})]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"glass-card p-4 rounded-2xl",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3 text-center",children:"Next Block"}),g&&e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"grid gap-0 border border-gray-600 rounded p-2 bg-black/30",style:{gridTemplateColumns:`repeat(${g.shape[0].length}, 1fr)`,width:"fit-content"},children:g.shape.map((s,t)=>s.map((a,l)=>e.jsx("div",{className:"border border-gray-700",style:{width:f*.8,height:f*.8,backgroundColor:a?g.color:"transparent"}},`${l}-${t}`)))})})]}),e.jsxs("div",{className:"glass-card p-4 rounded-2xl",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-3 text-center",children:"Controls"}),e.jsxs("div",{className:"text-sm text-gray-300 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Move Left:"}),e.jsx("kbd",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:"‚Üê"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Move Right:"}),e.jsx("kbd",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:"‚Üí"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Soft Drop:"}),e.jsx("kbd",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:"‚Üì"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Rotate:"}),e.jsx("kbd",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:"‚Üë"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Hard Drop:"}),e.jsx("kbd",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:"Space"})]})]})]})]})]}),!d&&e.jsxs(i.div,{className:"glass-card p-6 rounded-2xl mt-6 max-w-2xl mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:"üìã How to Play"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üéØ"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Objective:"})," Complete horizontal lines by filling them completely"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"‚ö°"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Controls:"})," Use arrow keys to move and rotate blocks"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üèÜ"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Score:"})," Points for lines cleared, higher levels increase speed"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"üíÄ"}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-white",children:"Game Over:"})," When blocks reach the top of the board"]})]})]})]})]})};export{F as default};
